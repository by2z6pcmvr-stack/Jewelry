<!doctype html>
<html lang="en" class="">

<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>"jewelry box | an archive"</title>
   <link rel="stylesheet" href="./resources/storyentry.css"> <!--this links your HTML file to your CSS style sheet in resources folder-->
   <link rel="stylesheet" href="https://use.typekit.net/nqp2fva.css">
   <link rel="stylesheet" href="https://use.typekit.net/nqp2fva.css">
   <link rel="icon" type="image/x-icon" href="./resources/"> <!--In href="" after resources, type in your file name to link an image for your favicon-->
   <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  </head>

<body>
<!--If you want to have a header with a graphic 'logo' you make for your archive, a link or menu to navigate to other page(s)-->
<header>
   <h1>TELL ME A STORY OR MEMORY YOU TIE TO JEWELRY</h1>
</header>

<div id="grid" class="grid" style="position:relative; width:100%; height:80vh; border:1px solid #ccc;"></div>

<!-- Modal for showing dot details -->
<div id="look" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; 
                      background: rgba(0,0,0,0.5); justify-content:center; align-items:center; display:flex;">
  <div class="modal" style="background:#fff; padding:20px;">
    <img class="dot" src="" style="width:150px; height:150px; object-fit:cover;" />
    <p></p>
    <button hide style="margin-top:10px;">Back</button>
  </div>
</div>

<!-- jQuery library -->
<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>

<!-- Script to load sheet data and handle modal -->
<script>
function getRandomInt(min, max) {
    return Math.floor(Math.random() * (max - min + 1)) + min;
}

const SPREADSHEET_ID = "10rG4JpMF3pGn7wJUmvX8kzmUzkW83rPqar8RVag_kmc";
const TAB_NAME = "Sheet1";

$(document).ready(function () {

  // Load data from Google Sheet
  $.getJSON(`https://opensheet.elk.sh/${SPREADSHEET_ID}/${TAB_NAME}`, function(data) {
    console.log("Loaded data:", data);

    data.forEach(function(row, index) {
      if(index === 0) return; // skip header

      // Create dot element
      let div = $(`
        <div class='modal' type='${row.type}' index='${index}' 
             style='position:absolute; top:${getRandomInt(0,80)}%; left:${getRandomInt(0,90)}%'>
          <img class='dot' src='${row.pearls}' alt='${row.pearls}' 
               style='width:60px; height:60px; object-fit:cover; cursor:pointer;' />
          <p>${row.msg}</p>
        </div>
      `);

      // Add dot to grid
      div.appendTo("#grid");
    });
  });

  // Click on dots to open modal
  $("#grid").on("click", ".modal", function() {
    let symbol = $(this).find(".dot").attr('src');
    let msg = $(this).find("p").text(); 

    $("#look .modal .dot").attr('src', symbol);
    $("#look .modal p").text(msg); 
    $("#look").css("display","flex"); // show modal
  });

  // Close modal when back button is clicked
  $("#look").on("click", "button[hide]", function(){
    $("#look").hide();
  });
});
</script>

</body>
</html>